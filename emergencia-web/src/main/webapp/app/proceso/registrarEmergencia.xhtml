<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="/resources/template/plantilla.xhtml">

    <ui:define name="content">
        <h:form prependId="false"> 
            
            <p:growl id="growl" showDetail="true" sticky="true" >
                <p:autoUpdate/>
            </p:growl>
            
            <p:panel header="Generalidades">
                <h:panelGrid columns="2">
                    <p:outputLabel value="Emergencia"/>
                    <p:outputPanel>
                        <p:inputText id="txtEmergencia" disabled="true" value="#{registroEmergenciaMB.emergenciaSeleccionada.nombreEmergencia}"/>
                        <p:commandButton value="..." onclick="PF('dlgEmergencia').show();" update="tblDatos"/>
                    </p:outputPanel>
                    <p:outputLabel value="Estado Albergue"/>
                    <p:selectOneMenu value="#{registroEmergenciaMB.estadoAlbergue}">
                        <f:selectItems value="#{registroEmergenciaMB.lstEstadoAlbergue}" var="estado" itemValue="#{estado.codigoEstado}" itemLabel="#{estado.nombreEstado}"/>
                    </p:selectOneMenu>
                    
                    <p:outputLabel value="Código C.E."/>
                    <p:outputPanel>
                        <p:inputText value="#{registroEmergenciaMB.codigoEntidad}" size="5" onkeyup="return this.value.length >= 5">
                            <p:ajax event="keyup" listener="#{registroEmergenciaMB.buscarEntidad()}" update="lblNombre lblCopDe" />
                        </p:inputText>
                        <p:outputLabel id="lblNombre" value="#{registroEmergenciaMB.vwCatalogoEntidad.nombre}"/>
                        <p:outputLabel id="lblCopDe" value="#{registroEmergenciaMB.vwCatalogoEntidad.codigoDepartamento}"/>
                    </p:outputPanel>
                </h:panelGrid>
            </p:panel>


            <p:dialog id="dlgEmergencia" widgetVar="dlgEmergencia" header="Emergencias registradas" modal="true"
                      width="500">
                <p:dataTable id="tblDatos" value="#{registroEmergenciaMB.lstTipoEmergencia}" var="tipo" selectionMode="single"
                             selection="#{registroEmergenciaMB.emergenciaSeleccionada}"
                             rowKey="#{tipo.codigoEmergencia}">

                    <p:ajax event="rowSelect" onsuccess="PF('dlgEmergencia').hide()" update="txtEmergencia"/>

                    <p:column headerText="ID" width="20" style="text-align: center;">
                        #{tipo.codigoEmergencia}
                    </p:column>
                    <p:column headerText="Nombre" >
                        <p:outputLabel value="#{tipo.nombreEmergencia}"/>
                    </p:column>
                    <p:column headerText="Observación" >
                        <p:outputLabel value="#{tipo.observacionEmergencia}"/>
                    </p:column>
                </p:dataTable>
            </p:dialog>
        </h:form>
    </ui:define>
</ui:composition>

